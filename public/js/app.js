// Generated by CoffeeScript 1.6.3
(function() {
  var App, ContactForm, GoogleMapCanvas;

  App = (function() {
    function App() {
      if ($('#map-canvas').length) {
        new GoogleMapCanvas(window.business_location);
      }
      if ($('#contact-form').length) {
        new ContactForm($('#contact-form'));
      }
      this.bindEvents();
    }

    App.prototype.bindEvents = function() {
      var _this = this;
      return $('a[href*=#]:not([href=#])').click(function(e) {
        return _this.smoothScroll(e);
      });
    };

    App.prototype.smoothScroll = function(e) {
      var elem, target;
      elem = e.target;
      if (location.pathname.replace(/^\//, '') === elem.pathname.replace(/^\//, '') && location.hostname === elem.hostname) {
        target = $(elem.hash);
        if (!target.length) {
          target = $("[name=" + (this.hash.slice(1)) + "]");
        }
        $('html,body').animate({
          scrollTop: target.offset().top - 82
        }, 1000);
        return false;
      }
    };

    return App;

  })();

  $(function() {
    if ($("#horizon").length) {
      return new App;
    }
  });

  ContactForm = (function() {
    function ContactForm() {
      this.contactForm = $("#contact-form");
      this.formURL = this.contactForm.attr("action");
      this.submitButton = this.contactForm.find("button[type=submit]");
      this.spinner = this.submitButton.find("#spinner");
      this.bindEvents();
    }

    ContactForm.prototype.bindEvents = function() {
      var _this = this;
      return this.contactForm.submit(function(e) {
        return _this.submitForm(e);
      });
    };

    ContactForm.prototype.submitForm = function(e) {
      var formData,
        _this = this;
      e.preventDefault();
      formData = this.contactForm.serialize();
      this.showSpinner();
      return $.ajax({
        url: this.formURL,
        type: "POST",
        data: formData,
        success: function(data, textStatus, jqXHR) {
          _this.hideSpinner();
          return _this.markSubmitSuccess();
        },
        error: function(jqXHR, textStatus, errorThrown) {
          _this.hideSpinner();
          return _this.markSubmitError();
        }
      });
    };

    ContactForm.prototype.showSpinner = function() {
      return this.spinner.removeClass("hidden");
    };

    ContactForm.prototype.hideSpinner = function() {
      return this.spinner.addClass("hidden");
    };

    ContactForm.prototype.markSubmitSuccess = function() {
      return this.submitButton.removeClass("btn-default").addClass("btn-success").addClass("disabled").html("Your enquiry has been sent");
    };

    ContactForm.prototype.markSubmitError = function() {
      return this.submitButton.removeClass("btn-default").addClass("btn-danger").html("Your enquiry has not been sent");
    };

    return ContactForm;

  })();

  GoogleMapCanvas = (function() {
    function GoogleMapCanvas(location) {
      var map, mapOptions, marker, myLatLng;
      console.log(location);
      myLatLng = new google.maps.LatLng(location.latitude, location.longitude);
      mapOptions = {
        zoom: 16,
        center: myLatLng
      };
      map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);
      marker = new google.maps.Marker({
        position: myLatLng,
        map: map,
        title: 'Horizon Centre'
      });
    }

    return GoogleMapCanvas;

  })();

}).call(this);
